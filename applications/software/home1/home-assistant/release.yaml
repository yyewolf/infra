apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: home-assistant
spec:
  interval: 5m
  chart:
    spec:
      chart: home-assistant
      version: 0.3.41
      sourceRef:
        kind: HelmRepository
        name: home-assistant
  values:
    configuration:
      enabled: true
      forceInit: true
      trusted_proxies:
      - 10.0.0.0/8
    additionalVolumes:
      - hostPath:
          path: >-
            /dev/serial/by-id/usb-Itead_Sonoff_Zigbee_3.0_USB_Dongle_Plus_V2_0a83b9ece0c2ef11b0cbecb08048b910-if00-port0
          type: CharDevice
        name: usb
    additionalMounts:
      - mountPath: /dev/ttyUSB0
        name: usb
    securityContext:
      privileged: true
    image:
      repository: mirror.gcr.io/homeassistant/home-assistant
    persistence:
      enabled: true
      storageClass: local-path-home1-retain
      annotations:
        k8up.io/backup: "true"
      size: 10Gi
    tolerations:
    - key: PrivateNode
      operator: Equal
      value: home1
